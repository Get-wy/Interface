(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e28ccdf"],{"1a8e":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"StaffBonusList-container"},[a("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"员工姓名"},model:{value:t.project_NameOrNumber,callback:function(e){t.project_NameOrNumber=e},expression:"project_NameOrNumber"}}),t._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.getButton}},[t._v("\n    查询\n  ")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:t.Output}},[a("svg-icon",{staticStyle:{width:"14px",height:"14.5px"},attrs:{iconClass:"excel"}}),t._v("\n    导出\n  ")],1),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-printer"},on:{click:t.print}},[t._v("\n    打印\n  ")]),t._v(" "),a("el-table",{staticStyle:{width:"80%","margin-top":"20px"},attrs:{data:t.tableData,border:"","summary-method":t.getSummaries,"show-summary":""}},[a("el-table-column",{attrs:{type:"index",prop:"index",label:"序号",width:"80",align:"center",fixed:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"staffName",label:"员工姓名",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"specialty",label:"所",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"calbonus",label:"计算产值",filters:[{text:"有",value:"有"},{text:"无",value:"无"}],"filter-method":t.filterTag,align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text","close-transition":""},on:{click:function(a){return t.handleClickStatus(e.row)}}},[t._v("\n          "+t._s(e.row.button)+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"adjustbonus",label:"调剂产值",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticClass:"Input",on:{blur:function(a){return t.blurBonusAdjust(e.$index,e.row)}},model:{value:e.row.bonusAdjust,callback:function(a){t.$set(e.row,"bonusAdjust",a)},expression:"scope.row.bonusAdjust"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"bonusInTotal",label:"产值合计",align:"center"}})],1),t._v(" "),a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary",disabled:1===t.user.institute||!t.againSubmit},on:{click:t.clickSave}},[t._v("\n    保存\n  ")])],1)},s=[],i=a("75fc"),r=a("db72"),u=(a("96cf"),a("3b8d")),o=(a("c5f6"),a("ac6a"),a("ed08")),l=a("add5"),c=a.n(l),b=a("a78e"),m=a.n(b),p={name:"StaffBonusList",data:function(){return{user:JSON.parse(m.a.get("userInfo")),specialty_Category:"",specialtyList:[],project_NameOrNumber:"",tableData:[],againSubmit:!1,tempTableData:[],sum3:0,sum4:0,sum5:0,loading:!1}},computed:{},methods:{filterTag:function(t,e){return"有"==t?e.calbonus>0:"无"==t?0==e.calbonus:void 0},getSummaries:function(t){var e=t.columns,a=t.data,n=[];return e.forEach((function(t,e){if(e<3)n[e]=0===e?"合计":"";else{var s=a.map((function(e){return Number(e[t.property])}));s.every((function(t){return isNaN(t)}))?n[e]="":(n[e]=s.reduce((function(t,e){var a=Number(e);return isNaN(a)?t:t+e}),0),3!==e&&4!==e&&5!==e||(n[e]=n[e].toFixed(2)))}})),n},handleClickStatus:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$router.push({path:"/bonus-principal-staff/StaffBonusDetail/".concat(e.staffNumber,"/").concat(e.staffName)});case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getButton:function(){var t={specialty:this.specialty_Category,userSelect:this.project_NameOrNumber};this.getStaffList(t)},clickSave:function(){var t=this;this.loading=!0;var e=this.tableData.map((function(t){return{userId:t.staffNumber,tiaojiBonus:t.bonusAdjust,userSeasonBonus:t.bonusInTotal}}));this.$store.dispatch("bonusPrincipal/saveStaffAdjustBonus",{tiaojiArray:e}).then((function(e){t.$message({message:"保存人员调剂产值成功",type:"success"});var a={specialty:t.specialty_Category,userSelect:t.project_NameOrNumber};t.getStaffList(a),t.loading=!1})).catch((function(e){t.$message({message:e,type:"error"}),t.loading=!1}))},getStaffList:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$store.dispatch("bonusPrincipal/getStaffBonusList",e).then((function(t){for(var e in a.tableData=t.data,a.tableData)a.tableData[e].specialty=Object(o["a"])(a.tableData[e].specialty,a.specialtyList),a.tableData[e].calbonus=a.tableData[e].button,a.tableData[e].adjustbonus=a.tableData[e].bonusAdjust;a.againSubmit=t.againSubmit,console.log(a.tableData,"1"),a.loading=!1})).catch((function(t){a.loading=!1,a.$message({message:t,type:"error"})}));case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),Output:function(){var t=this;for(var e in this.tempTableData.length=0,this.sum3=0,this.sum4=0,this.sum5=0,this.tableData)this.tempTableData[e]=Object(r["a"])({},{index:Number(e)+1},{},this.tableData[e]),this.sum3+=Number(this.tempTableData[e].calbonus),this.sum4+=Number(this.tempTableData[e].adjustbonus),this.sum5+=Number(this.tempTableData[e].bonusInTotal);this.tempTableData=[].concat(Object(i["a"])(this.tempTableData),[{index:"合计",staffName:"",specialty:"",calbonus:Number(this.sum3).toFixed(2),adjustbonus:Number(this.sum4).toFixed(2),bonusInTotal:Number(this.sum5).toFixed(2)}]),this.downloadLoading=!0,Promise.all([a.e("chunk-e69e90f4"),a.e("chunk-2181d362")]).then(a.bind(null,"4bf8d")).then((function(e){var a=["序号","员工姓名","所","计算产值","调剂产值","产值合计"],n=["index","staffName","specialty","calbonus","adjustbonus","bonusInTotal"],s=t.tempTableData,i=t.formatJson(n,s);e.export_json_to_excel({header:a,data:i,filename:"本季度人员产值列表",autoWidth:!0,bookType:"xlsx"}),t.downloadLoading=!1}))},print:function(){for(var t in this.tempTableData.length=0,this.sum3=0,this.sum4=0,this.sum5=0,this.tableData)this.tempTableData[t]=Object(r["a"])({},{index:Number(t)+1},{},this.tableData[t]),this.sum3+=Number(this.tempTableData[t].calbonus),this.sum4+=Number(this.tempTableData[t].adjustbonus),this.sum5+=Number(this.tempTableData[t].bonusInTotal);this.tempTableData=[].concat(Object(i["a"])(this.tempTableData),[{index:"合计",staffName:"",specialty:"",calbonus:Number(this.sum3).toFixed(2),adjustbonus:Number(this.sum4).toFixed(2),bonusInTotal:Number(this.sum5).toFixed(2)}]);var e={printable:this.tempTableData,properties:[{field:"index",displayName:"序号"},{field:"staffName",displayName:"员工姓名"},{field:"specialty",displayName:"所"},{field:"calbonus",displayName:"计算产值"},{field:"adjustbonus",displayName:"调剂产值"},{field:"bonusInTotal",displayName:"产值合计"}],type:"json",gridHeaderStyle:"color: black;  border: 1px solid #000000;",gridStyle:"border: 1px solid #000000;"};c()(e)},formatJson:function(t,e){return e.map((function(e){return t.map((function(t){return e[t]}))}))},blurBonusAdjust:function(t,e){console.log(t,e),isNaN(e.bonusAdjust)?e.bonusAdjust=0:e.bonusAdjust=Number(e.bonusAdjust).toFixed(2),this.tableData[t].adjustbonus=e.bonusAdjust,this.tableData[t].bonusInTotal=(Number(e.button)+Number(e.bonusAdjust)).toFixed(2)},readSettings:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){e.$store.dispatch("settings/getSettings").then((function(a){e.specialtyList=a.placeList,e.specialtyList.push({value:"",label:"所"}),t()})).catch((function(){}))})));case 1:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),init:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,this.readSettings();case 3:this.getStaffList({specialty:this.specialty_Category,userSelect:this.project_NameOrNumber});case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},activated:function(){this.init()},mounted:function(){this.init()}},d=p,f=d,h=(a("a382"),a("2877")),g=Object(h["a"])(f,n,s,!1,null,"2371c5a0",null);e["default"]=g.exports},a382:function(t,e,a){"use strict";var n=a("c00b"),s=a.n(n);s.a},c00b:function(t,e,a){},ed08:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return s}));a("28a5"),a("a481"),a("6b54"),a("7618");function n(t,e){for(var a in e)if(e[a].value==t)return e[a].label}function s(t,e){for(var a in e)if(e[a].label==t)return e[a].value}}}]);