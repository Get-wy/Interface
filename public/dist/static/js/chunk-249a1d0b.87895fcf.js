(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-249a1d0b"],{"44b0":function(t,e,a){},"909b":function(t,e,a){"use strict";var s=a("44b0"),r=a.n(s);r.a},eef2:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"BonusSubspecialtyList-container"},[a("el-page-header",{staticStyle:{"margin-left":"30px","margin-bottom":"30px"},attrs:{title:"返回"},on:{back:t.goBack}}),t._v(" "),a("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,"label-width":"100px"}},[a("el-form-item",{staticClass:"short",attrs:{label:"项目编号"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.project_Number,callback:function(e){t.$set(t.form,"project_Number",e)},expression:"form.project_Number"}})],1),t._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"项目名称"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.project_Name,callback:function(e){t.$set(t.form,"project_Name",e)},expression:"form.project_Name"}})],1),t._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"项目类别"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.project_Category,callback:function(e){t.$set(t.form,"project_Category",e)},expression:"form.project_Category"}})],1),t._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"设计阶段"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.design_Stage,callback:function(e){t.$set(t.form,"design_Stage",e)},expression:"form.design_Stage"}})],1),t._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"当前季度"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.current_Season,callback:function(e){t.$set(t.form,"current_Season",e)},expression:"form.current_Season"}})],1),t._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"当前所"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.current_Specialty,callback:function(e){t.$set(t.form,"current_Specialty",e)},expression:"form.current_Specialty"}})],1),t._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"专业季度产值"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.season_bonus,callback:function(e){t.$set(t.form,"season_bonus",e)},expression:"form.season_bonus"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"产值分配"}},[a("el-table",{staticStyle:{"margin-top":"15px",width:"80%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"subspecialty",label:"专业",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"专业负责人",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{placeholder:"",disabled:""},model:{value:e.row.subspecialtyPrincipal,callback:function(a){t.$set(e.row,"subspecialtyPrincipal",a)},expression:"scope.row.subspecialtyPrincipal"}},t._l(t.userList,(function(t){return a("el-option",{key:t.user_id,attrs:{label:t.user_name,value:t.user_id}})})),1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"subspecialtyBonusRatio",label:"产值比例",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticClass:"Input",attrs:{disabled:""},on:{blur:function(a){return t.calcuBonus(e.$index,e.row)}},model:{value:e.row.subspecialtyBonusRatio,callback:function(a){t.$set(e.row,"subspecialtyBonusRatio",a)},expression:"scope.row.subspecialtyBonusRatio"}},[a("i",{staticClass:"icon iconfont icon-baifenbi",staticStyle:{"line-height":"40px"},attrs:{slot:"suffix"},slot:"suffix"})])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"subspecialtyBonus",label:"专业季度产值",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"button",label:"阶段状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("tag",{attrs:{open:"未录入"===e.row.button||"已录入"===e.row.button,type:"button",text:e.row.button},nativeOn:{click:function(a){return t.handleClickStatus(e.row)}}})]}}])})],1)],1)],1)],1)},r=[],o=(a("96cf"),a("3b8d")),n=(a("c5f6"),a("3022"),a("ed08")),i=a("a78e"),c=a.n(i),l=a("c28c"),u={name:"",data:function(){return{propject_CategoryList:[],design_StageList:[],specialtyList:[],stageStatusDesignprinciple:[],form:{},userList:[],n:0,tableData:[]}},components:{Tag:l["a"]},computed:{},methods:{goBack:function(){this.$router.push({name:"产值查询",params:{type:this.$route.params.type}})},renderRatio:function(t){return(100*Number(t)).toFixed(2)+"%"},handleClickStatus:function(t){"未录入"===t.button||"已录入"===t.button||this.$router.push({path:"/ProductionValueList/BonusSubspecialty/".concat(this.form.project_Number,"/").concat(t.subspecialty,"/").concat(this.$route.params.seasonName,"/").concat(this.$route.params.type)})},getList:function(){var t=this,e={};"环境"==this.$route.params.specialty?e={id:this.$route.params.id,specialty:1,seasonName:this.$route.params.seasonName}:"结构"==this.$route.params.specialty?e={id:this.$route.params.id,specialty:2,seasonName:this.$route.params.seasonName}:"电仪"==this.$route.params.specialty&&(e={id:this.$route.params.id,specialty:3,seasonName:this.$route.params.seasonName}),this.$store.dispatch("bonusPrincipal/getBonusSubspecialtyList",e).then((function(e){for(var a in t.form=e,t.tableData=e.data,t.form.project_Category=Object(n["a"])(t.form.project_Category,t.propject_CategoryList),t.form.design_Stage=Object(n["a"])(t.form.design_Stage,t.design_StageList),t.form.current_Specialty=Object(n["a"])(t.form.current_Specialty,t.specialtyList),console.log(t.form,"22"),e.data)t.tableData[a].button=Object(n["a"])(t.tableData[a].button,t.stageStatusDesignprinciple)})).catch((function(e){t.$message({message:e,type:"warning"})}))},getUserList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){var s={page:"no",userCard:3};a.$store.dispatch("user/userList",s).then((function(e){a.userList=e.data,t()})).catch((function(){e()}))})));case 1:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),calcuBonus:function(t,e){console.log(t,e,this.tableData),this.tableData[t].subspecialtyBonus=(this.form.season_bonus*e.subspecialtyBonusRatio/100).toFixed(2)},onSubmit:function(){var t=this;for(var e in this.tableData)this.tableData[e].subspecialtyBonusRatio=this.tableData[e].subspecialtyBonusRatio/100;var a=[];a.data=this.tableData.map((function(t){return{subspecialty:t.subspecialty,ratio:t.subspecialtyBonusRatio,bonus:t.subspecialtyBonus,person:t.subspecialtyPrincipal}}));var s={projectId:this.form.project_Number,subspecialtyArray:a.data};console.log(s,this.form,this.tableData),this.$store.dispatch("bonusPrincipal/updateBonusSubspecialtyList",s).then((function(e){t.$message({message:"修改成功",type:"success"}),t.goBack()})).catch((function(e){t.$message({message:e,type:"error"})}))},init:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("settings/getSettings").then((function(t){e.propject_CategoryList=t.projectCategory,e.design_StageList=t.designPhase,e.specialtyList=t.placeList,e.stageStatusDesignprinciple=t.stageStatusDesignprinciple})).catch((function(){}));case 2:return t.next=4,this.getUserList();case 4:this.getList();case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){console.log(JSON.parse(c.a.get("userInfo"))),this.init()}},p=u,m=(a("909b"),a("2877")),b=Object(m["a"])(p,s,r,!1,null,"333419fc",null);e["default"]=b.exports}}]);