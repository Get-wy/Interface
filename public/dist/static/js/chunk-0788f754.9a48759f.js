(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0788f754"],{"22a9":function(e,t,a){},"2aa6":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{cursor:"pointer"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择",disabled:e.myProps},on:{change:e.handleClick2},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},[e._l(e.a,(function(t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"环境"==e.scope.row.place,expression:"scope.row.place == '环境'"}],key:t.user_id,attrs:{label:t.user_name,value:t.user_id},on:{change:e.handleClick2}})})),e._v(" "),e._l(e.b,(function(t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"结构"==e.scope.row.place,expression:"scope.row.place == '结构'"}],key:t.user_id,attrs:{label:t.user_name,value:t.user_id},on:{change:e.handleClick2}})})),e._v(" "),e._l(e.c,(function(t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"电仪"==e.scope.row.place,expression:"scope.row.place == '电仪'"}],key:t.user_id,attrs:{label:t.user_name,value:t.user_id},on:{change:e.handleClick2}})}))],2)],1)},s=[],o=(a("96cf"),a("3b8d")),i={data:function(){return{a:[],b:[],c:[],value2:"",userList:[]}},props:{value:{require:!0},scope:{default:null},myProps:{type:Boolean,default:!1}},computed:{test:function(){return this.scope.row.principal},text:function(){}},watch:{test:function(){this.value2=this.scope.row.principal}},mounted:function(){this.value2=this.scope.row.principal,this.init()},methods:{handleClick2:function(){this.$emit("input",this.value2)},getUserList2:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var r={userCard:"专业负责人",userName:"",page:"no"};t.$store.dispatch("user/userList",r).then((function(a){t.userList=a.data,e()})).catch((function(e){a(e)}))})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),init:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getUserList2();case 2:for(t in this.userList)"1"==this.userList[t].specialty?this.a.push(this.userList[t]):"2"==this.userList[t].specialty?this.b.push(this.userList[t]):"3"==this.userList[t].specialty&&this.c.push(this.userList[t]);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},n=i,l=a("2877"),u=Object(l["a"])(n,r,s,!1,null,null,null);t["a"]=u.exports},"456d":function(e,t,a){var r=a("4bf8"),s=a("0d58");a("5eda")("keys",(function(){return function(e){return s(r(e))}}))},"504c":function(e,t,a){var r=a("9e1e"),s=a("0d58"),o=a("6821"),i=a("52a7").f;e.exports=function(e){return function(t){var a,n=o(t),l=s(n),u=l.length,c=0,h=[];while(u>c)a=l[c++],r&&!i.call(n,a)||h.push(e?[a,n[a]]:n[a]);return h}}},"5eda":function(e,t,a){var r=a("5ca1"),s=a("8378"),o=a("79e5");e.exports=function(e,t){var a=(s.Object||{})[e]||Object[e],i={};i[e]=t(a),r(r.S+r.F*o((function(){a(1)})),"Object",i)}},bf25:function(e,t,a){"use strict";var r=a("22a9"),s=a.n(r);s.a},ff6c:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"project-add"},[a("el-page-header",{attrs:{title:"返回",content:"项目新增"},on:{back:e.goBack}}),e._v(" "),a("el-form",{ref:"ruleForm",staticClass:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"140px"}},[a("el-form-item",{staticClass:"short",attrs:{label:"项目编号",prop:"id"}},[a("el-input",{model:{value:e.ruleForm.id,callback:function(t){e.$set(e.ruleForm,"id",t)},expression:"ruleForm.id"}})],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"项目名称",prop:"projectName"}},[a("el-input",{model:{value:e.ruleForm.projectName,callback:function(t){e.$set(e.ruleForm,"projectName",t)},expression:"ruleForm.projectName"}})],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"总投资额(万元)",prop:"investment"}},[a("el-input",{on:{blur:e.compute},model:{value:e.ruleForm.investment,callback:function(t){e.$set(e.ruleForm,"investment",t)},expression:"ruleForm.investment"}})],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"项目类别",prop:"projectCategory"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目类别"},on:{change:e.compute},model:{value:e.ruleForm.projectCategory,callback:function(t){e.$set(e.ruleForm,"projectCategory",t)},expression:"ruleForm.projectCategory"}},e._l(e.project_category,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"主体所",prop:"mainBody"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择主体所"},model:{value:e.ruleForm.mainBody,callback:function(t){e.$set(e.ruleForm,"mainBody",t)},expression:"ruleForm.mainBody"}},e._l(e.place_list,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"设计阶段",prop:"designPhase"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设计阶段"},on:{change:e.compute},model:{value:e.ruleForm.designPhase,callback:function(t){e.$set(e.ruleForm,"designPhase",t)},expression:"ruleForm.designPhase"}},e._l(e.design_phase,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),"7"===e.ruleForm.designPhase?a("el-form-item",{staticClass:"short",attrs:{label:"其它设计阶段名称",prop:"designPhaseName"}},[a("el-input",{model:{value:e.ruleForm.designPhaseName,callback:function(t){e.$set(e.ruleForm,"designPhaseName",t)},expression:"ruleForm.designPhaseName"}})],1):e._e(),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"基本奖金(元)",prop:"basicBonus"}},[a("el-input",{attrs:{disabled:"7"!==e.ruleForm.designPhase},on:{change:e.changeSumValue},model:{value:e.ruleForm.basicBonus,callback:function(t){e.$set(e.ruleForm,"basicBonus",t)},expression:"ruleForm.basicBonus"}})],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"设计负责人",prop:"designManager"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设计负责人"},model:{value:e.ruleForm.designManager,callback:function(t){e.$set(e.ruleForm,"designManager",t)},expression:"ruleForm.designManager"}},e._l(e.designManagerList,(function(e){return a("el-option",{key:e.user_id,attrs:{label:e.user_name,value:e.user_id}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"地域调整系数",prop:"areaValue"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},on:{blur:e.changeAreaValue},model:{value:e.ruleForm.areaValue,callback:function(t){e.$set(e.ruleForm,"areaValue",t)},expression:"ruleForm.areaValue"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{slot:"prepend",placeholder:"请选择"},on:{change:e.areaValueSelect},slot:"prepend",model:{value:e.selectProject,callback:function(t){e.selectProject=t},expression:"selectProject"}},[a("el-option",{attrs:{label:"上海项目",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"外地项目",value:"2"}})],1)],1)],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"综合调整系数",prop:"sumValue"}},[a("el-input",{on:{change:e.changeSumValue},model:{value:e.ruleForm.sumValue,callback:function(t){e.$set(e.ruleForm,"sumValue",t)},expression:"ruleForm.sumValue"}})],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"计算产值奖金(元)",prop:"calculateBonus"}},[a("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.calculateBonus,callback:function(t){e.$set(e.ruleForm,"calculateBonus",t)},expression:"ruleForm.calculateBonus"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"1000px"},attrs:{label:"所分配比例"}},[a("d2-crud",{ref:"d2Crud",attrs:{columns:e.columns,data:e.tableData,options:e.borders},on:{"cell-data-change":e.handleFormDataChange}}),e._v(" "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.showWarning<100,expression:"showWarning < 100"}],attrs:{underline:!1,type:"warning"}},[e._v("未完全分配比例")]),e._v(" "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.showWarning>100,expression:"showWarning > 100"}],attrs:{underline:!1,type:"danger"}},[e._v("分配比例错误")])],1),e._v(" "),a("el-form-item",{staticStyle:{width:"1000px"},attrs:{label:"专业分配比例"}},[a("d2-crud",{ref:"d2Crud2",attrs:{columns:e.columns2,data:e.tableData2,options:e.borders2},on:{"cell-data-change":e.handleFormDataChangeTableData2}}),e._v(" "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.showWarning2<100&&e.tableData[0].proportion>0,expression:"showWarning2 < 100 && tableData[0].proportion>0"}],attrs:{underline:!1,type:"warning"}},[e._v("环境所小专业未完全分配比例,")]),e._v(" "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.showWarning3<100&&e.tableData[1].proportion>0,expression:"showWarning3 < 100 && tableData[1].proportion>0"}],attrs:{underline:!1,type:"warning"}},[e._v("结构所小专业未完全分配比例,")]),e._v(" "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.showWarning4<100&&e.tableData[2].proportion>0,expression:"showWarning4 < 100 && tableData[2].proportion>0"}],attrs:{underline:!1,type:"warning"}},[e._v("电仪所小专业未完全分配比例")])],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"阶段总产值奖金(元)",prop:"calculateBonus"}},[a("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.allOutputValue,callback:function(t){e.$set(e.ruleForm,"allOutputValue",t)},expression:"ruleForm.allOutputValue"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),a("el-button",{on:{click:e.goBack}},[e._v("取消")])],1)],1)],1)},s=[],o=(a("96cf"),a("3b8d")),i=(a("ffc1"),a("db72")),n=(a("456d"),a("ac6a"),a("c5f6"),a("da6f")),l=a("2aa6"),u={name:"project-add",data:function(){var e=function(e,t,a){var r=Number(t);r>1e8?a(new Error("请输入正确的总投资额(0~100000000万元)")):a()},t=function(e,t,a){var r=Number(t);r>10||r<0?a(new Error("输入范围为0-10之间")):a()};return{oldval1:1,oldval2:1,oldval3:1,principalStatus:!1,ruleForm:{id:"",projectName:"",investment:"",projectCategory:"",mainBody:"",designPhase:"",designPhaseName:"",basicBonus:"",designManager:"",areaValue:"1",sumValue:1,calculateBonus:"",allOutputValue:""},rules:{designPhaseName:[{required:!0,message:"请输入其它设计阶段名称",trigger:"blur"}],basicBonus:[{required:!0,message:"请输入基本奖金",trigger:"blur"}],id:[{required:!0,message:"请输入项目编号",trigger:"blur"}],projectName:[{required:!0,message:"请输入项目名称",trigger:"blur"}],investment:[{required:!0,message:"请输入总投资额",trigger:"blur"},{validator:e,trigger:"blur"}],projectCategory:[{required:!0,message:"请选择项目类别",trigger:"change"}],mainBody:[{required:!0,message:"请选择主体所",trigger:"change"}],designPhase:[{required:!0,message:"请选择设计阶段",trigger:"change"}],designManager:[{required:!0,message:"请选择设计负责人",trigger:"change"}],areaValue:[{required:!0,message:"请输入地域调整系数",trigger:"blur"},{validator:t,trigger:"blur"}],sumValue:[{required:!0,message:"请输入综合调整系数",trigger:"blur"},{validator:t,trigger:"blur"}]},selectProject:"1",tableData:[{proportion:0},{proportion:0},{proportion:0}],borders:{border:!0,showSummary:!0,summaryMethod:function(e){var t=e.columns,a=e.data,r=[];return t.forEach((function(e,t){if(0!==t){var s=a.map((function(t){return Number(t[e.property])}));s.every((function(e){return isNaN(e)}))?r[t]="":(r[t]=s.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),1!==t&&4!==t||(r[t]=r[t].toFixed(2))),2!==t&&3!==t||(r[t]="")}else r[t]="总计"})),r}},tableData2:[],options:[{value:"选项1",label:"黄金糕"}],showWarning:0,showWarning2:0,showWarning3:0,showWarning4:0,columns:[],columns2:[],borders2:{border:!0,showSummary:!0,summaryMethod:function(e){var t=e.columns,a=e.data,r=[];return t.forEach((function(e,t){if(0!==t){var s=a.map((function(t){return Number(t[e.property])}));s.every((function(e){return isNaN(e)}))||3!==t?r[t]="":(r[t]=s.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),3===t&&(r[t]=r[t].toFixed(2)))}else r[t]="总计"})),r},spanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;if(0===a)return t%3===0?{rowspan:3,colspan:1}:{rowspan:0,colspan:0}}},project_category:[],design_phase:[],designManagerList:[{label:"zhangsan",value:1}],place_list:[],a:0,userList2:[]}},components:{MyTag:l["a"]},computed:{test:function(){return this.ruleForm.calculateBonus}},watch:{test:function(){for(var e in console.log("当计算产值奖金变化 进行计算 表格一 表格二",this.tableData,this.tableData2),this.setData(),this.tableData)this.tableData[e].outputValue=(this.ruleForm.calculateBonus*(this.tableData[e].proportion/100)*this.tableData[e].coefficient*(this.tableData[e].upperLimit/100)).toFixed(2);this.tableData2Computed()}},methods:{setData:function(){for(var e in this.tableData)this.$set(this.tableData,e,this.tableData[e]);for(var t in this.tableData2)console.log(this.tableData2[t]),this.$set(this.tableData2,t,this.tableData2[t]);for(var a in this.showWarning=0,this.tableData)this.showWarning+=Number(this.tableData[a].proportion);for(var r in this.showWarning2=0,this.showWarning3=0,this.showWarning4=0,this.ruleForm.allOutputValue=0,this.tableData2)"环境"==this.tableData2[r].place?this.showWarning2+=Number(this.tableData2[r].proportion):"结构"==this.tableData2[r].place?this.showWarning3+=Number(this.tableData2[r].proportion):"电仪"==this.tableData2[r].place&&(this.showWarning4+=Number(this.tableData2[r].proportion)),this.ruleForm.allOutputValue+=parseFloat(this.tableData2[r].outputValue);this.showWarning=this.showWarning.toFixed(2),this.showWarning2=this.showWarning2.toFixed(2),this.showWarning3=this.showWarning3.toFixed(2),this.showWarning4=this.showWarning4.toFixed(2),this.ruleForm.allOutputValue=this.ruleForm.allOutputValue.toFixed(2)},tablePaddingProportion:function(){var e=n["a"].get("project").suobili,t=n["a"].get("project").zhuanyebili,a=this.ruleForm.projectCategory,r=this.ruleForm.designPhase;if(a&&r&&"7"!==this.ruleForm.designPhase){var s={};for(var o in e)if(a==o)for(var l in e[o])r==l&&(s=e[o][l]);if(0!==Object.keys(s).length){var u=this.tableData[0];u.proportion=s.hj,this.$set(this.tableData,0,u);var c=this.tableData[1];c.proportion=s.jg,this.$set(this.tableData,1,c);var h=this.tableData[2];h.proportion=s.dy,this.$set(this.tableData,2,h)}var p=[];for(var m in t)if(a==m)for(var d in t[m])r==d&&(p=t[m][d],console.log(t[m][d]));if(0!==Object.keys(p).length)for(var b in this.tableData2)console.log("json1[i]",p[b]),this.$set(this.tableData2,b,Object(i["a"])({},this.tableData2[b],{proportion:p[b]}))}this.setData()},compute:function(){"7"===this.ruleForm.designPhase?console.log("不进行公式计算"):(this.ruleForm.designPhaseName="",this.blurInvestment(),this.changeProjectCategory(),this.changeDesignPhase()),this.ruleForm.areaValue&&this.ruleForm.sumValue&&(this.ruleForm.calculateBonus=(this.ruleForm.basicBonus*this.ruleForm.areaValue*this.ruleForm.sumValue).toFixed(2)),this.tableData2Computed(),this.tablePaddingProportion()},areaValueSelect:function(e){console.log(e,this.selectProject),this.ruleForm.areaValue=1==e?1:1.1,this.compute()},changeAreaValue:function(){(isNaN(this.ruleForm.areaValue)||Number(this.ruleForm.areaValue)<0)&&(this.ruleForm.areaValue=1),this.compute()},changeSumValue:function(){(isNaN(this.ruleForm.sumValue)||Number(this.ruleForm.sumValue)<0)&&(this.ruleForm.sumValue=1),this.ruleForm.areaValue&&this.ruleForm.sumValue&&(this.ruleForm.calculateBonus=(this.ruleForm.basicBonus*this.ruleForm.areaValue*this.ruleForm.sumValue).toFixed(2))},handleFormDataChange:function(e){var t=e.rowIndex,a=(e.key,e.value,e.row);for(var r in isNaN(a.proportion)||Number(a.proportion)<0||Number(a.proportion)>100?a.proportion=0:a.proportion=Number(a.proportion).toFixed(2),(isNaN(a.coefficient)||Number(a.coefficient)<0)&&(a.coefficient=1),isNaN(a.upperLimit)||Number(a.upperLimit)<100?a.upperLimit=100:a.upperLimit=parseInt(a.upperLimit),0===t?this.oldval1=Number(a.upperLimit)/100:1===t?this.oldval2=Number(a.upperLimit)/100:2===t&&(this.oldval3=Number(a.upperLimit)/100),console.log("特殊处理 所计算产值",this.oldval1,this.oldval2,this.oldval3),this.showWarning=0,this.$refs.d2Crud.d2CrudData)this.showWarning+=Number(this.$refs.d2Crud.d2CrudData[r].proportion);(Number(a.upperLimit)<100||isNaN(a.upperLimit))&&(a.upperLimit=100),this.tableData[t]=a,this.tableData[t].outputValue=(this.ruleForm.calculateBonus*(a.proportion/100)*a.coefficient*(Number(this.tableData[t].upperLimit)/100)).toFixed(2),console.log("xiugaihou",this.tableData,this.columns2),this.showWarning=this.showWarning.toFixed(2),this.tableData2Computed()},handleFormDataChangeTableData2:function(e){var t=e.rowIndex,a=e.key,r=e.value,s=e.row;for(var o in isNaN(s.proportion)||Number(s.proportion)<0||Number(s.proportion)>100?s.proportion=0:s.proportion=Number(s.proportion).toFixed(2),this.tableData2[t]=s,"环境"==s.place?this.tableData[0].proportion>1?this.tableData2[t].outputValue=(this.tableData[0].outputValue*(this.tableData2[t].proportion/100)).toFixed(2):this.tableData2[t].proportion=0:"结构"==s.place?this.tableData[1].proportion>1?this.tableData2[t].outputValue=(this.tableData[1].outputValue*(this.tableData2[t].proportion/100)).toFixed(2):this.tableData2[t].proportion=0:"电仪"==s.place&&this.tableData[2].proportion>1&&(this.tableData[2].proportion>1?this.tableData2[t].outputValue=(this.tableData[2].outputValue*(this.tableData2[t].proportion/100)).toFixed(2):this.tableData2[t].proportion=0),console.log({rowIndex:t,key:a,value:r,row:s},this.tableData2),this.showWarning2=0,this.showWarning3=0,this.showWarning4=0,this.ruleForm.allOutputValue=0,this.tableData2)"环境"==this.tableData2[o].place?(this.showWarning2+=Number(this.tableData2[o].proportion),this.showWarning2>100?(this.tableData2[t].proportion=0,this.tableData2[t].outputValue=0):100==this.showWarning2?console.log("环境小专"):console.log("环境小专业未完全分配")):"结构"==this.tableData2[o].place?(this.showWarning3+=Number(this.tableData2[o].proportion),this.showWarning3>100?(this.tableData2[t].proportion=0,this.tableData2[t].outputValue=0):100==this.showWarning3?console.log("结构小专"):console.log("结构小专业未完全分配")):"电仪"==this.tableData2[o].place&&(this.showWarning4+=Number(this.tableData2[o].proportion),this.showWarning4>100?(this.tableData2[t].proportion=0,this.tableData2[t].outputValue=0):100==this.showWarning4?console.log("电仪小专"):console.log("电仪小专业未完全分配")),this.ruleForm.allOutputValue+=parseFloat(this.tableData2[o].outputValue);this.showWarning2=this.showWarning2.toFixed(2),this.showWarning3=this.showWarning3.toFixed(2),this.showWarning4=this.showWarning4.toFixed(2),this.ruleForm.allOutputValue=this.ruleForm.allOutputValue.toFixed(2)},tableData2Computed:function(){for(var e in console.log("表格二计算"),this.ruleForm.allOutputValue=0,this.tableData2)"环境"==this.tableData2[e].place?this.tableData[0].proportion>1?this.tableData2[e].outputValue=parseFloat(this.tableData[0].outputValue*(this.tableData2[e].proportion/100)).toFixed(2):this.tableData2[e].proportion="":"结构"==this.tableData2[e].place?this.tableData[1].proportion>1?this.tableData2[e].outputValue=parseFloat(this.tableData[1].outputValue*(this.tableData2[e].proportion/100)).toFixed(2):this.tableData2[e].proportion="":"电仪"==this.tableData2[e].place&&this.tableData[2].proportion>1&&(this.tableData[2].proportion>1?this.tableData2[e].outputValue=parseFloat(this.tableData[2].outputValue*(this.tableData2[e].proportion/100)).toFixed(2):this.tableData2[e].proportion=""),this.ruleForm.allOutputValue+=parseFloat(this.tableData2[e].outputValue);this.ruleForm.allOutputValue=this.ruleForm.allOutputValue.toFixed(2)},goBack:function(){this.$router.push({path:"/project-manage/list"})},submitForm:function(e){var t=this;if(100==this.showWarning){for(var a in this.$refs.d2Crud2.d2CrudData)if(this.$refs.d2Crud2.d2CrudData[a].proportion>0){if(console.log(this.$refs.d2Crud2.d2CrudData,this.tableData2),!this.$refs.d2Crud2.d2CrudData[a].principal)return void this.$message({message:"请选择专业负责人",type:"warning"});this.principalStatus=!0}if(this.principalStatus){var r=this.$refs.d2Crud2.d2CrudData;for(var s in r){if(100!==Number(this.showWarning2))return void this.$message({message:"环境所小专业比例未完全分配",type:"error"});if(100!==Number(this.showWarning3))return void this.$message({message:"结构所小专业比例未完全分配",type:"error"});if(100!==Number(this.showWarning4))return void this.$message({message:"电仪所小专业比例未完全分配",type:"error"});if(Number(r[s].proportion)>0&&null===r[s].principal)return void this.$message({message:"请为".concat(r[s].place,"所的").concat(r[s].specialty,"专业选择专业负责人"),type:"error"});if(Number(r[s].proportion)>0&&""===r[s].principal)return void this.$message({message:"请为".concat(r[s].place,"所的").concat(r[s].specialty,"专业选择专业负责人"),type:"error"})}this.$refs[e].validate((function(e){if(e){var a=Object(i["a"])({},t.ruleForm,{specialtyArray:t.$refs.d2Crud.data,subspecialtyArray:t.$refs.d2Crud2.d2CrudData,selectProject:t.selectProject,val1:t.oldval1,val2:t.oldval2,val3:t.oldval3});return console.log(a),new Promise((function(e,r){t.$store.dispatch("adminProduction/addProject",a).then((function(a){console.log(a),t.$message({message:"新增项目信息成功!",type:"success"}),t.$router.push({path:"/project-manage/list"}),e()})).catch((function(e){t.$message({message:e,type:"error"}),r(e)}))}))}return console.log("error submit!!"),!1}))}}else this.$message({message:"请查看所分配比例",type:"warning"})},resetForm:function(e){this.$refs[e].resetFields()},blurInvestment:function(){this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment),this.ruleForm.basicBonus=parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment))?parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment)).toFixed(2):0},changeProjectCategory:function(){this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment),this.ruleForm.basicBonus=parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment))?parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment)).toFixed(2):0},changeDesignPhase:function(){this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment),this.ruleForm.basicBonus=parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment))?parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment)).toFixed(2):0},countMethoud:function(e,t,a){var r=n["a"].get("project").jibenjiang;if(e&&t&&a){var s={};for(var o in r)if(e==o)for(var i in r[o])t==i&&(s=r[o][i]);for(var l in Object.entries(s)){if(parseFloat(a)>0&&parseFloat(a)<500){var u=(Object.entries(s)[0][1]-0)/(Object.entries(s)[0][0]-0)*(parseFloat(a)-0)+0;return u}if(500===parseFloat(a))return Object.entries(s)[0][1];if(parseFloat(a)>500&&parseFloat(a)<5e3){var c=(Object.entries(s)[1][1]-Object.entries(s)[0][1])/(Object.entries(s)[1][0]-Object.entries(s)[0][0])*(parseFloat(a)-Object.entries(s)[0][0])+Object.entries(s)[0][1];return c}if(5e3===parseFloat(a))return Object.entries(s)[1][1];if(parseFloat(a)>5e3&&parseFloat(a)<1e4){var h=(Object.entries(s)[2][1]-Object.entries(s)[1][1])/(Object.entries(s)[2][0]-Object.entries(s)[1][0])*(parseFloat(a)-Object.entries(s)[1][0])+Object.entries(s)[1][1];return h}if(1e4===parseFloat(a))return Object.entries(s)[2][1];if(parseFloat(a)>1e4&&parseFloat(a)<2e4){var p=(Object.entries(s)[3][1]-Object.entries(s)[2][1])/(Object.entries(s)[3][0]-Object.entries(s)[2][0])*(parseFloat(a)-Object.entries(s)[2][0])+Object.entries(s)[2][1];return p}if(2e4===parseFloat(a))return Object.entries(s)[3][1];if(parseFloat(a)>2e4&&parseFloat(a)<5e4){var m=(Object.entries(s)[4][1]-Object.entries(s)[3][1])/(Object.entries(s)[4][0]-Object.entries(s)[3][0])*(parseFloat(a)-Object.entries(s)[3][0])+Object.entries(s)[3][1];return m}if(5e4===parseFloat(a))return Object.entries(s)[4][1];if(Number(a)>5e4){var d=(Object.entries(s)[4][1]-Object.entries(s)[3][1])/(Object.entries(s)[4][0]-Object.entries(s)[3][0])*(parseFloat(a)-Object.entries(s)[4][0])+Object.entries(s)[4][1];return d}return}}},getUserList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t={userCard:"设计负责人",userName:"",page:"no"},this.$store.dispatch("user/userList",t).then((function(e){a.designManagerList=e.data})).catch((function(){}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getUserList2:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var r={userCard:"专业负责人",userName:"",page:"no"};t.$store.dispatch("user/userList",r).then((function(a){t.userList2=a.data,e()})).catch((function(e){a(e)}))})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getSettings:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){t.$store.dispatch("settings/getProject").then((function(t){console.log("项目基本奖金",t),e()})).catch((function(){console.log("查询项目奖金json文件出错")}))})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),init:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getSettings();case 2:return e.next=4,this.getUserList();case 4:return e.next=6,this.getUserList2();case 6:return e.next=8,this.$store.dispatch("settings/getSettings").then((function(e){t.project_category=e.projectCategory,t.design_phase=e.designPhase,t.place_list=e.placeList,t.tableData=e.tableData,t.tableData2=e.tableData2,t.columns=e.columns,t.columns2[0]=e.columns2[0],t.columns2[1]=e.columns2[1],t.columns2[2]=e.columns2[2],t.columns2[3]=e.columns2[3],t.columns2[4]={title:"专业负责人",key:"principal",component:{name:l["a"],props:{myProps:!1},input:""}}})).catch((function(){console.log("查询项目配置json文件出错")}));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){},created:function(){this.init()}},c=u,h=c,p=(a("bf25"),a("2877")),m=Object(p["a"])(h,r,s,!1,null,null,null);t["default"]=m.exports},ffc1:function(e,t,a){var r=a("5ca1"),s=a("504c")(!0);r(r.S,"Object",{entries:function(e){return s(e)}})}}]);