(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-543dc3d4"],{"2aa6":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{cursor:"pointer"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择",disabled:e.myProps},on:{change:e.handleClick2},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},[e._l(e.a,(function(t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"环境"==e.scope.row.place,expression:"scope.row.place == '环境'"}],key:t.user_id,attrs:{label:t.user_name,value:t.user_id},on:{change:e.handleClick2}})})),e._v(" "),e._l(e.b,(function(t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"结构"==e.scope.row.place,expression:"scope.row.place == '结构'"}],key:t.user_id,attrs:{label:t.user_name,value:t.user_id},on:{change:e.handleClick2}})})),e._v(" "),e._l(e.c,(function(t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"电仪"==e.scope.row.place,expression:"scope.row.place == '电仪'"}],key:t.user_id,attrs:{label:t.user_name,value:t.user_id},on:{change:e.handleClick2}})}))],2)],1)},o=[],s=(a("96cf"),a("3b8d")),i={data:function(){return{a:[],b:[],c:[],value2:"",userList:[]}},props:{value:{require:!0},scope:{default:null},myProps:{type:Boolean,default:!1}},computed:{test:function(){return this.scope.row.principal},text:function(){}},watch:{test:function(){this.value2=this.scope.row.principal}},mounted:function(){this.value2=this.scope.row.principal,this.init()},methods:{handleClick2:function(){this.$emit("input",this.value2)},getUserList2:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var r={userCard:"专业负责人",userName:"",page:"no"};t.$store.dispatch("user/userList",r).then((function(a){t.userList=a.data,e()})).catch((function(e){a(e)}))})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),init:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getUserList2();case 2:for(t in this.userList)"1"==this.userList[t].specialty?this.a.push(this.userList[t]):"2"==this.userList[t].specialty?this.b.push(this.userList[t]):"3"==this.userList[t].specialty&&this.c.push(this.userList[t]);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},n=i,l=a("2877"),u=Object(l["a"])(n,r,o,!1,null,null,null);t["a"]=u.exports},"43a2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"project-edit"},[a("el-page-header",{attrs:{title:"返回",content:"项目修改"},on:{back:e.goBack}}),e._v(" "),a("el-form",{ref:"ruleForm",staticClass:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"140px"}},[a("el-form-item",{staticClass:"short",attrs:{label:"项目编号",prop:"id"}},[a("el-input",{attrs:{disabled:"true"!==e.$route.params.edit},model:{value:e.ruleForm.id,callback:function(t){e.$set(e.ruleForm,"id",t)},expression:"ruleForm.id"}})],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"项目名称",prop:"projectName"}},[a("el-input",{attrs:{disabled:"true"!==e.$route.params.edit},model:{value:e.ruleForm.projectName,callback:function(t){e.$set(e.ruleForm,"projectName",t)},expression:"ruleForm.projectName"}})],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"总投资额(万元)",prop:"investment"}},[a("el-input",{attrs:{disabled:"true"!==e.$route.params.edit},on:{blur:e.compute},model:{value:e.ruleForm.investment,callback:function(t){e.$set(e.ruleForm,"investment",t)},expression:"ruleForm.investment"}})],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"项目类别",prop:"projectCategory"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目类别",disabled:"true"!==e.$route.params.edit},on:{change:e.compute},model:{value:e.ruleForm.projectCategory,callback:function(t){e.$set(e.ruleForm,"projectCategory",t)},expression:"ruleForm.projectCategory"}},e._l(e.project_category,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"主体所",prop:"mainBody"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"true"!==e.$route.params.edit,placeholder:"请选择主体所"},model:{value:e.ruleForm.mainBody,callback:function(t){e.$set(e.ruleForm,"mainBody",t)},expression:"ruleForm.mainBody"}},e._l(e.place_list,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"设计阶段",prop:"designPhase"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设计阶段",disabled:"true"!==e.$route.params.edit},on:{change:e.compute},model:{value:e.ruleForm.designPhase,callback:function(t){e.$set(e.ruleForm,"designPhase",t)},expression:"ruleForm.designPhase"}},e._l(e.design_phase,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),"7"===e.ruleForm.designPhase?a("el-form-item",{staticClass:"short",attrs:{label:"其它设计阶段名称",prop:"designPhaseName"}},[a("el-input",{attrs:{disabled:"true"!==e.$route.params.edit},model:{value:e.ruleForm.designPhaseName,callback:function(t){e.$set(e.ruleForm,"designPhaseName",t)},expression:"ruleForm.designPhaseName"}})],1):e._e(),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"基本奖金(元)",prop:"basicBonus"}},[a("el-input",{attrs:{disabled:"7"!==e.ruleForm.designPhase||"true"!==e.$route.params.edit},on:{change:e.changeSumValue},model:{value:e.ruleForm.basicBonus,callback:function(t){e.$set(e.ruleForm,"basicBonus",t)},expression:"ruleForm.basicBonus"}})],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"设计负责人",prop:"designManager"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设计负责人"},model:{value:e.ruleForm.designManager,callback:function(t){e.$set(e.ruleForm,"designManager",t)},expression:"ruleForm.designManager"}},e._l(e.designManagerList,(function(e){return a("el-option",{key:e.user_id,attrs:{label:e.user_name,value:e.user_id}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"地域调整系数",prop:"areaValue"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",disabled:"true"!==e.$route.params.edit},on:{blur:e.blurAreaValue},model:{value:e.ruleForm.areaValue,callback:function(t){e.$set(e.ruleForm,"areaValue",t)},expression:"ruleForm.areaValue"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{slot:"prepend",placeholder:"请选择",disabled:"true"!==e.$route.params.edit},on:{change:e.areaValueSelect},slot:"prepend",model:{value:e.selectProject,callback:function(t){e.selectProject=t},expression:"selectProject"}},[a("el-option",{attrs:{label:"上海项目",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"外地项目",value:"2"}})],1)],1)],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"综合调整系数",prop:"sumValue"}},[a("el-input",{attrs:{disabled:"true"!==e.$route.params.edit},on:{change:e.changeSumValue},model:{value:e.ruleForm.sumValue,callback:function(t){e.$set(e.ruleForm,"sumValue",t)},expression:"ruleForm.sumValue"}})],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"计算产值奖金(元)",prop:"calculateBonus"}},[a("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.calculateBonus,callback:function(t){e.$set(e.ruleForm,"calculateBonus",t)},expression:"ruleForm.calculateBonus"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"1000px"},attrs:{label:"所分配比例"}},[a("d2-crud",{ref:"d2Crud",attrs:{columns:e.columns,data:e.tableData,options:e.borders},on:{"cell-data-change":e.handleFormDataChange}}),e._v(" "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.showWarning<100,expression:"showWarning < 100"}],attrs:{underline:!1,type:"warning"}},[e._v("未完全分配比例")]),e._v(" "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.showWarning>100,expression:"showWarning > 100"}],attrs:{underline:!1,type:"danger"}},[e._v("分配比例错误")])],1),e._v(" "),a("el-form-item",{staticStyle:{width:"1000px"},attrs:{label:"专业分配比例"}},[a("d2-crud",{ref:"d2Crud2",attrs:{columns:e.columns2,data:e.tableData2,options:e.borders2},on:{"cell-data-change":e.handleFormDataChangeTableData2}}),e._v(" "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.showWarning2<100&&e.tableData[0].proportion>0,expression:"showWarning2 < 100 && tableData[0].proportion>0"}],attrs:{underline:!1,type:"warning"}},[e._v("环境所小专业未完全分配比例,")]),e._v(" "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.showWarning3<100&&e.tableData[1].proportion>0,expression:"showWarning3 < 100 && tableData[1].proportion>0"}],attrs:{underline:!1,type:"warning"}},[e._v("结构所小专业未完全分配比例,")]),e._v(" "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.showWarning4<100&&e.tableData[2].proportion>0,expression:"showWarning4 < 100 && tableData[2].proportion>0"}],attrs:{underline:!1,type:"warning"}},[e._v("电仪所小专业未完全分配比例")])],1),e._v(" "),a("el-form-item",{staticClass:"short",attrs:{label:"阶段总产值奖金(元)",prop:"calculateBonus"}},[a("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.allOutputValue,callback:function(t){e.$set(e.ruleForm,"allOutputValue",t)},expression:"ruleForm.allOutputValue"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("修改")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{disabled:e.delState,type:"danger"},on:{click:e.del}},[e._v("删除")])],1)],1)],1)},o=[],s=(a("96cf"),a("3b8d")),i=(a("ffc1"),a("db72")),n=(a("456d"),a("ac6a"),a("c5f6"),a("da6f")),l=a("2aa6"),u={name:"project-edit",data:function(){var e=function(e,t,a){""===t||t>1e8?a(new Error("请输入正确的总投资额(0~100000000万元)")):a()},t=function(e,t,a){var r=Number(t);r>10||r<0?a(new Error("输入范围为0-10之间")):a()};return{oldval1:1,oldval2:1,oldval3:1,ruleForm:{id:"",projectName:"",investment:"",projectCategory:"",mainBody:"",designPhase:"",designPhaseName:"",basicBonus:"",designManager:"",areaValue:"1",sumValue:"",calculateBonus:"",allOutputValue:""},rules:{designPhaseName:[{required:!0,message:"请输入其它设计阶段名称",trigger:"blur"}],basicBonus:[{required:!0,message:"请输入基本奖金",trigger:"blur"}],id:[{required:!0,message:"请输入项目编号",trigger:"blur"}],projectName:[{required:!0,message:"请输入项目名称",trigger:"blur"}],investment:[{required:!0,message:"请输入总投资额",trigger:"blur"},{validator:e,trigger:"blur"}],projectCategory:[{required:!0,message:"请选择项目类别",trigger:"change"}],mainBody:[{required:!0,message:"请选择主体所",trigger:"change"}],designPhase:[{required:!0,message:"请选择设计阶段",trigger:"change"}],designManager:[{required:!0,message:"请选择设计负责人",trigger:"change"}],areaValue:[{required:!0,message:"请输入地域调整系数",trigger:"blur"},{validator:t,trigger:"blur"}],sumValue:[{required:!0,message:"请输入综合调整系数",trigger:"blur"},{validator:t,trigger:"blur"}]},selectProject:"1",tableData:[{proportion:0},{proportion:0},{proportion:0}],borders:{border:!0,showSummary:!0,summaryMethod:function(e){var t=e.columns,a=e.data,r=[];return t.forEach((function(e,t){if(0!==t){var o=a.map((function(t){return Number(t[e.property])}));o.every((function(e){return isNaN(e)}))?r[t]="":(r[t]=o.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),1!==t&&4!==t||(r[t]=r[t].toFixed(2))),2!==t&&3!==t||(r[t]="")}else r[t]="总计"})),console.log("最终",r),r}},tableData2:[],options:[{value:"选项1",label:"黄金糕"}],showWarning:0,showWarning2:0,showWarning3:0,showWarning4:0,columns:[],columns2:[],borders2:{border:!0,showSummary:!0,summaryMethod:function(e){var t=e.columns,a=e.data,r=[];return t.forEach((function(e,t){if(0!==t){var o=a.map((function(t){return Number(t[e.property])}));o.every((function(e){return isNaN(e)}))||3!==t?r[t]="":(r[t]=o.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),3===t&&(r[t]=r[t].toFixed(2)))}else r[t]="总计"})),r},spanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;if(0===a)return t%3===0?{rowspan:3,colspan:1}:{rowspan:0,colspan:0}}},project_category:[],design_phase:[],designManagerList:[{label:"zhangsan",value:1}],place_list:[],a:0,userList2:[]}},components:{MyTag:l["a"]},computed:{test:function(){return this.ruleForm.calculateBonus},delState:function(){return!0!==this.ruleForm.deleteProjectStatus}},watch:{test:function(){for(var e in console.log("循环计算"),this.setData(),this.tableData)this.tableData[e].outputValue=(this.ruleForm.calculateBonus*(this.tableData[e].proportion/100)*this.tableData[e].coefficient*(Number(this.tableData[e].upperLimit)/100)).toFixed(2);this.$refs.d2Crud.d2CrudData=this.tableData,this.tableData2Computed()}},methods:{setData:function(){for(var e in this.tableData)this.$set(this.tableData,e,this.tableData[e]);for(var t in this.tableData2)this.$set(this.tableData2,t,this.tableData2[t]);for(var a in this.showWarning=0,this.tableData)this.showWarning+=Number(this.tableData[a].proportion);for(var r in this.showWarning2=0,this.showWarning3=0,this.showWarning4=0,this.ruleForm.allOutputValue=0,this.tableData2)"环境"==this.tableData2[r].place?this.showWarning2+=Number(this.tableData2[r].proportion):"结构"==this.tableData2[r].place?this.showWarning3+=Number(this.tableData2[r].proportion):"电仪"==this.tableData2[r].place&&(this.showWarning4+=Number(this.tableData2[r].proportion)),this.ruleForm.allOutputValue+=parseFloat(this.tableData2[r].outputValue);this.ruleForm.allOutputValue=this.ruleForm.allOutputValue.toFixed(2)},tablePaddingProportion:function(){var e=n["a"].get("project").suobili,t=n["a"].get("project").zhuanyebili,a=this.ruleForm.projectCategory,r=this.ruleForm.designPhase;if(a&&r){var o={};for(var s in e)if(a==s)for(var l in e[s])r==l&&(o=e[s][l]);if(0!==Object.keys(o).length){var u=this.tableData[0];u.proportion=o.hj,this.$set(this.tableData,0,u);var c=this.tableData[1];c.proportion=o.jg,this.$set(this.tableData,1,c);var h=this.tableData[2];h.proportion=o.dy,this.$set(this.tableData,2,h)}var p=[];for(var m in t)if(a==m)for(var d in t[m])r==d&&(p=t[m][d],console.log(t[m][d]));if(0!==Object.keys(p).length)for(var b in this.tableData2)this.$set(this.tableData2,b,Object(i["a"])({},this.tableData2[b],{proportion:p[b]}))}},blurAreaValue:function(){(isNaN(this.ruleForm.areaValue)||Number(this.ruleForm.areaValue)<0)&&(this.ruleForm.areaValue=1),this.compute()},warrning:function(){this.showWarning=0,this.showWarning2=0,this.showWarning3=0,this.showWarning4=0;for(var e=0;e<this.$refs.d2Crud.d2CrudData.length;e++)this.showWarning+=Number(this.$refs.d2Crud.d2CrudData[e].proportion);for(var t in this.tableData2)"环境"==this.tableData2[t].place?this.showWarning2+=Number(this.tableData2[t].proportion):"结构"==this.tableData2[t].place?this.showWarning3+=Number(this.tableData2[t].proportion):"电仪"==this.tableData2[t].place&&(this.showWarning4+=Number(this.tableData2[t].proportion));this.showWarning=this.showWarning.toFixed(2),this.showWarning2=this.showWarning2.toFixed(2),this.showWarning3=this.showWarning3.toFixed(2),this.showWarning4=this.showWarning4.toFixed(2)},compute:function(){"7"===this.ruleForm.designPhase?console.log("不进行公式计算"):(this.ruleForm.designPhaseName="",this.blurInvestment(),this.changeProjectCategory(),this.changeDesignPhase()),this.ruleForm.areaValue&&this.ruleForm.sumValue&&(this.ruleForm.calculateBonus=(this.ruleForm.basicBonus*this.ruleForm.areaValue*this.ruleForm.sumValue).toFixed(2)),this.tableData2Computed(),this.tablePaddingProportion()},areaValueSelect:function(e){console.log(e,this.selectProject),this.ruleForm.areaValue=1==e?1:1.1,this.compute()},changeAreaValue:function(){(isNaN(this.ruleForm.areaValue)||Number(this.ruleForm.areaValue)<0)&&(this.ruleForm.areaValue=1),this.compute()},changeSumValue:function(){(isNaN(this.ruleForm.sumValue)||Number(this.ruleForm.sumValue)<0)&&(this.ruleForm.sumValue=1),this.ruleForm.areaValue&&this.ruleForm.sumValue&&(this.ruleForm.calculateBonus=parseFloat(this.ruleForm.basicBonus*this.ruleForm.areaValue*this.ruleForm.sumValue).toFixed(2))},handleFormDataChange:function(e){var t=e.rowIndex,a=e.key,r=e.value,o=e.row;for(var s in console.log("{ rowIndex, key, value, row }",{rowIndex:t,key:a,value:r,row:o}),isNaN(o.proportion)||Number(o.proportion)<0||Number(o.proportion)>100?o.proportion=0:o.proportion=Number(o.proportion).toFixed(2),(isNaN(o.coefficient)||Number(o.coefficient)<0)&&(o.coefficient=1),0===t?this.oldval1=Number(o.upperLimit)/100:1===t?this.oldval2=Number(o.upperLimit)/100:2===t&&(this.oldval3=Number(o.upperLimit)/100),this.showWarning=0,this.$refs.d2Crud.d2CrudData)this.showWarning+=Number(this.$refs.d2Crud.d2CrudData[s].proportion);Number(o.upperLimit)<0||isNaN(o.upperLimit)?o.upperLimit=0:o.upperLimit=parseInt(o.upperLimit),this.showWarning=this.showWarning.toFixed(2),this.tableData[t]=o,this.tableData[t].outputValue=(this.ruleForm.calculateBonus*(o.proportion/100)*o.coefficient*(Number(this.tableData[t].upperLimit)/100)).toFixed(2),console.log("xiugaihou",this.tableData,this.columns2),this.tableData2Computed()},tableData2Computed:function(){for(var e in console.log("最终值"),this.ruleForm.allOutputValue=0,this.tableData2)"环境"==this.tableData2[e].place?this.tableData[0].proportion>1?this.tableData2[e].outputValue=parseFloat(this.tableData[0].outputValue*(this.tableData2[e].proportion/100)).toFixed(2):this.tableData2[e].proportion="":"结构"==this.tableData2[e].place?this.tableData[1].proportion>1?this.tableData2[e].outputValue=parseFloat(this.tableData[1].outputValue*(this.tableData2[e].proportion/100)).toFixed(2):this.tableData2[e].proportion="":"电仪"==this.tableData2[e].place&&this.tableData[2].proportion>1&&(this.tableData[2].proportion>1?this.tableData2[e].outputValue=parseFloat(this.tableData[2].outputValue*(this.tableData2[e].proportion/100)).toFixed(2):this.tableData2[e].proportion=""),this.ruleForm.allOutputValue+=Number(this.tableData2[e].outputValue);this.ruleForm.allOutputValue=this.ruleForm.allOutputValue.toFixed(2),this.$refs.d2Crud2.d2CrudData=this.tableData2},handleFormDataChangeTableData2:function(e){var t=e.rowIndex,a=e.key,r=e.value,o=e.row;for(var s in isNaN(o.proportion)||Number(o.proportion)<0||Number(o.proportion)>100?o.proportion=0:o.proportion=parseInt(o.proportion),console.log("修改第二个表",{rowIndex:t,key:a,value:r,row:o}),this.tableData2[t]=o,"环境"==o.place?this.tableData[0].proportion>1?this.tableData2[t].outputValue=(this.tableData[0].outputValue*(this.tableData2[t].proportion/100)).toFixed(2):this.tableData2[t].proportion=0:"结构"==o.place?this.tableData[1].proportion>1?this.tableData2[t].outputValue=(this.tableData[1].outputValue*(this.tableData2[t].proportion/100)).toFixed(2):this.tableData2[t].proportion=0:"电仪"==o.place&&this.tableData[2].proportion>1&&(this.tableData[2].proportion>1?this.tableData2[t].outputValue=(this.tableData[2].outputValue*(this.tableData2[t].proportion/100)).toFixed(2):this.tableData2[t].proportion=0),console.log({rowIndex:t,key:a,value:r,row:o},this.tableData2),this.showWarning2=0,this.showWarning3=0,this.showWarning4=0,this.ruleForm.allOutputValue=0,this.tableData2)"环境"==this.tableData2[s].place?(this.showWarning2+=Number(this.tableData2[s].proportion),this.showWarning2>100?(this.tableData2[t].proportion=0,this.tableData2[t].outputValue=0):100==this.showWarning2?console.log("环境小专"):console.log("环境小专业未完全分配")):"结构"==this.tableData2[s].place?(this.showWarning3+=Number(this.tableData2[s].proportion),this.showWarning3>100?(this.tableData2[t].proportion=0,this.tableData2[t].outputValue=0):100==this.showWarning3?console.log("结构小专"):console.log("结构小专业未完全分配")):"电仪"==this.tableData2[s].place&&(this.showWarning4+=Number(this.tableData2[s].proportion),this.showWarning4>100?(this.tableData2[t].proportion=0,this.tableData2[t].outputValue=0):100==this.showWarning4?console.log("电仪小专"):console.log("电仪小专业未完全分配")),this.ruleForm.allOutputValue+=parseFloat(this.tableData2[s].outputValue);this.showWarning2=this.showWarning2.toFixed(2),this.showWarning3=this.showWarning3.toFixed(2),this.showWarning4=this.showWarning4.toFixed(2),this.ruleForm.allOutputValue=this.ruleForm.allOutputValue.toFixed(2)},goBack:function(){this.$router.push({name:"项目管理",params:{page:this.$route.params.page}})},submitForm:function(e){var t=this;console.log("提交",this.$refs.d2Crud2.data);var a=this.$refs.d2Crud2.data;for(var r in a){if(100!==Number(this.showWarning2))return void this.$message({message:"环境所小专业比例未完全分配",type:"error"});if(100!==Number(this.showWarning3))return void this.$message({message:"结构所小专业比例未完全分配",type:"error"});if(100!==Number(this.showWarning4))return void this.$message({message:"电仪所小专业比例未完全分配",type:"error"});if(Number(a[r].proportion)>0&&null===a[r].principal)return void this.$message({message:"请为".concat(a[r].place,"所的").concat(a[r].specialty,"专业选择专业负责人"),type:"error"});if(Number(a[r].proportion)>0&&""===a[r].principal)return void this.$message({message:"请为".concat(a[r].place,"所的").concat(a[r].specialty,"专业选择专业负责人"),type:"error"})}this.$refs[e].validate((function(e){if(e){for(var a in t.tableData[0].outputValue=(Number(t.tableData[0].outputValue)/t.oldval1).toFixed(2),t.tableData[1].outputValue=(Number(t.tableData[1].outputValue)/t.oldval2).toFixed(2),t.tableData[2].outputValue=(Number(t.tableData[2].outputValue)/t.oldval3).toFixed(2),t.$refs.d2Crud2.data)a<3?t.$refs.d2Crud2.data[a].outputValue=(Number(t.$refs.d2Crud2.data[a].outputValue)/t.oldval1).toFixed(2):a>2&&a<6?t.$refs.d2Crud2.data[a].outputValue=(Number(t.$refs.d2Crud2.data[a].outputValue)/t.oldval2).toFixed(2):a>5&&a<8&&(t.$refs.d2Crud2.data[a].outputValue=(Number(t.$refs.d2Crud2.data[a].outputValue)/t.oldval3).toFixed(2));var r=Object(i["a"])({},t.ruleForm,{specialtyArray:t.tableData,subspecialtyArray:t.$refs.d2Crud2.data,selectProject:t.selectProject});return console.log("提交数据",r),new Promise((function(e,a){t.$store.dispatch("adminProduction/setProject",r).then((function(a){t.$message({type:"success",message:"修改成功!"}),t.$router.push({name:"项目管理",params:{page:t.$route.params.page}}),e()})).catch((function(e){t.$message({message:e,type:"error"}),a(e)}))}))}return console.log("error submit!!"),!1}))},del:function(){var e=this;this.$confirm("此操作将永久删除该项目(包含历史数据), 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return new Promise((function(t,a){e.$store.dispatch("adminProduction/delProject",{projectId:e.$route.params.id}).then((function(a){e.$message({type:"success",message:"删除成功!"}),e.$router.push({name:"项目管理",params:{page:e.$route.params.page}}),t()})).catch((function(t){e.$message({message:t,type:"error"}),a(t)}))}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},resetForm:function(e){this.$router.push({name:"项目管理",params:{page:this.$route.params.page}})},blurInvestment:function(){this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment),this.ruleForm.basicBonus=parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment))?parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment)).toFixed(2):0,console.log("计算出",this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment))},changeProjectCategory:function(){this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment),console.log("计算出",this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment)),this.ruleForm.basicBonus=parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment))?parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment)).toFixed(2):0},changeDesignPhase:function(){this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment),console.log("计算出",this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment)),this.ruleForm.basicBonus=parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment))?parseFloat(this.countMethoud(this.ruleForm.projectCategory,this.ruleForm.designPhase,this.ruleForm.investment)).toFixed(2):0},countMethoud:function(e,t,a){console.log(e,t,a);var r=n["a"].get("project").jibenjiang;if(e&&t&&a){var o={};for(var s in r)if(e==s)for(var i in r[s])t==i&&(o=r[s][i]);for(var l in console.log("json",Object.entries(o)),Object.entries(o)){if(console.log(Object.entries(o)[l]),parseFloat(a)>0&&parseFloat(a)<500){console.log("1",Object.entries(o)[0][1]-0,Object.entries(o)[0][0]-0,parseFloat(a)-0);var u=(Object.entries(o)[0][1]-0)/(Object.entries(o)[0][0]-0)*(parseFloat(a)-0)+0;return u}if(500===parseFloat(a))return console.log("2",Object.entries(o)[0]),Object.entries(o)[0][1];if(parseFloat(a)>500&&parseFloat(a)<5e3){var c=(Object.entries(o)[1][1]-Object.entries(o)[0][1])/(Object.entries(o)[1][0]-Object.entries(o)[0][0])*(parseFloat(a)-Object.entries(o)[0][0])+Object.entries(o)[0][1];return c}if(5e3===parseFloat(a))return console.log("2",Object.entries(o)[1]),Object.entries(o)[1][1];if(parseFloat(a)>5e3&&parseFloat(a)<1e4){var h=(Object.entries(o)[2][1]-Object.entries(o)[1][1])/(Object.entries(o)[2][0]-Object.entries(o)[1][0])*(parseFloat(a)-Object.entries(o)[1][0])+Object.entries(o)[1][1];return h}if(1e4===parseFloat(a))return console.log("2",Object.entries(o)[2]),Object.entries(o)[2][1];if(parseFloat(a)>1e4&&parseFloat(a)<2e4){var p=(Object.entries(o)[3][1]-Object.entries(o)[2][1])/(Object.entries(o)[3][0]-Object.entries(o)[2][0])*(parseFloat(a)-Object.entries(o)[2][0])+Object.entries(o)[2][1];return p}if(2e4===parseFloat(a))return console.log("2",Object.entries(o)[3]),Object.entries(o)[3][1];if(parseFloat(a)>2e4&&parseFloat(a)<5e4){var m=(Object.entries(o)[4][1]-Object.entries(o)[3][1])/(Object.entries(o)[4][0]-Object.entries(o)[3][0])*(parseFloat(a)-Object.entries(o)[3][0])+Object.entries(o)[3][1];return m}if(5e4===parseFloat(a))return console.log("2",Object.entries(o)[4]),Object.entries(o)[4][1];if(Number(a)>5e4){var d=(Object.entries(o)[4][1]-Object.entries(o)[3][1])/(Object.entries(o)[4][0]-Object.entries(o)[3][0])*(parseFloat(a)-Object.entries(o)[4][0])+Object.entries(o)[4][1];return d}return void console.log("算不出")}}},getUserList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t={userCard:"设计负责人",userName:"",page:"no"},this.$store.dispatch("user/userList",t).then((function(e){a.designManagerList=e.data})).catch((function(){}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getUserList2:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var r={userCard:"专业负责人",userName:"",page:"no"};t.$store.dispatch("user/userList",r).then((function(a){console.log(a.data),t.userList2=a.data,e()})).catch((function(e){a(e)}))})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getEditProject:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){t.$store.dispatch("adminProduction/getEditProject",t.$route.params.id).then((function(a){t.ruleForm={id:a.id,projectName:a.projectName,investment:a.investment,projectCategory:a.projectCategory,mainBody:a.mainBody,designPhase:a.designPhase,basicBonus:a.basicBonus,designManager:a.designManager,areaValue:a.areaValue,sumValue:a.sumValue,calculateBonus:a.calculateBonus,allOutputValue:a.allOutputValue,designPhaseName:a.designPhaseName,deleteProjectStatus:a.deleteProjectStatus},t.tableData=a.tableData,t.tableData2=a.tableData2,t.oldval1=Number(t.tableData[0].upperLimit)/100,t.oldval2=Number(t.tableData[1].upperLimit)/100,t.oldval3=Number(t.tableData[2].upperLimit)/100,e(),console.log("查询项目res",a)})).catch((function(){console.log("查询项目配置json文件出错")}))})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getSettings:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){t.$store.dispatch("settings/getProject").then((function(t){console.log("项目基本奖金",t),e()})).catch((function(){console.log("查询项目奖金json文件出错")}))})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),init:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getSettings();case 2:return e.next=4,this.getUserList();case 4:return e.next=6,this.getUserList2();case 6:return e.next=8,this.$store.dispatch("settings/getSettings").then((function(e){console.log(e),t.project_category=e.projectCategory,t.design_phase=e.designPhase,t.place_list=e.placeList,t.tableData=e.tableData,t.tableData2=e.tableData2;var a=e.columns;a[1].component.disabled="true"!==t.$route.params.edit,a[2].component.disabled="true"!==t.$route.params.edit,t.columns=a;var r=e.columns2[2];r.component.disabled="true"!==t.$route.params.edit,console.log("日",r),t.columns2[0]=e.columns2[0],t.columns2[1]=e.columns2[1],t.columns2[2]=r,t.columns2[3]=e.columns2[3],t.columns2[4]={title:"专业负责人",key:"principal",component:{name:l["a"],props:{myProps:!1},input:""}}})).catch((function(){console.log("查询项目配置json文件出错1")}));case 8:return e.next=10,this.getEditProject();case 10:this.warrning();case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){this.init()},destroyed:function(){n["a"].remove("sbTable")}},c=u,h=c,p=(a("c228"),a("2877")),m=Object(p["a"])(h,r,o,!1,null,"01cdfbe3",null);t["default"]=m.exports},"456d":function(e,t,a){var r=a("4bf8"),o=a("0d58");a("5eda")("keys",(function(){return function(e){return o(r(e))}}))},"504c":function(e,t,a){var r=a("9e1e"),o=a("0d58"),s=a("6821"),i=a("52a7").f;e.exports=function(e){return function(t){var a,n=s(t),l=o(n),u=l.length,c=0,h=[];while(u>c)a=l[c++],r&&!i.call(n,a)||h.push(e?[a,n[a]]:n[a]);return h}}},5989:function(e,t,a){},"5eda":function(e,t,a){var r=a("5ca1"),o=a("8378"),s=a("79e5");e.exports=function(e,t){var a=(o.Object||{})[e]||Object[e],i={};i[e]=t(a),r(r.S+r.F*s((function(){a(1)})),"Object",i)}},c228:function(e,t,a){"use strict";var r=a("5989"),o=a.n(r);o.a},ffc1:function(e,t,a){var r=a("5ca1"),o=a("504c")(!0);r(r.S,"Object",{entries:function(e){return o(e)}})}}]);