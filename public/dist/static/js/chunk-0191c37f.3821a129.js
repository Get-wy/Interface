(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0191c37f"],{"379e":function(t,e,s){},5715:function(t,e,s){"use strict";var a=s("379e"),r=s.n(a);r.a},e229:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"projectprogress-container"},[s("el-page-header",{staticStyle:{"margin-left":"30px","margin-bottom":"30px"},attrs:{title:"返回"},on:{back:t.goBack}}),t._v(" "),s("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"阶段状态"}},[s("tag",{attrs:{type:"tag",text:t.form.stage_Status}})],1),t._v(" "),s("el-form-item",{staticClass:"short",attrs:{label:"项目编号"}},[s("el-input",{attrs:{disabled:""},model:{value:t.form.project_Number,callback:function(e){t.$set(t.form,"project_Number",e)},expression:"form.project_Number"}})],1),t._v(" "),s("el-form-item",{staticClass:"short",attrs:{label:"项目名称"}},[s("el-input",{attrs:{disabled:""},model:{value:t.form.project_Name,callback:function(e){t.$set(t.form,"project_Name",e)},expression:"form.project_Name"}})],1),t._v(" "),s("el-form-item",{staticClass:"short",attrs:{label:"项目类别"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:"请选择"},model:{value:t.form.project_Category,callback:function(e){t.$set(t.form,"project_Category",e)},expression:"form.project_Category"}},t._l(t.project_CategoryList,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),s("el-form-item",{staticClass:"short",attrs:{label:"设计阶段"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:"请选择"},model:{value:t.form.design_Stage,callback:function(e){t.$set(t.form,"design_Stage",e)},expression:"form.design_Stage"}},t._l(t.design_StageList,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),s("el-form-item",{staticClass:"short",attrs:{label:"当前季度"}},[s("el-input",{attrs:{disabled:""},model:{value:t.form.current_Season,callback:function(e){t.$set(t.form,"current_Season",e)},expression:"form.current_Season"}})],1),t._v(" "),s("el-form-item",{staticClass:"short",attrs:{label:"设计负责人"}},[s("el-input",{attrs:{disabled:""},model:{value:t.form.design_Principal,callback:function(e){t.$set(t.form,"design_Principal",e)},expression:"form.design_Principal"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"进度调整"}},[s("el-table",{staticStyle:{"margin-top":"15px",width:"90%"},attrs:{data:t.tableData,border:""}},[s("el-table-column",{attrs:{prop:"specialty",label:"所",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{prop:"bonusInTotal",label:"所计算产值",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{label:"所进度上限",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.progressSpecialtyLimit+"%"))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"progressDistributed",label:"已发放进度",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{prop:"bonusDistributed",label:"已发放产值",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{prop:"progressReserved",label:"剩余进度",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{prop:"bonusReserved",label:"剩余产值",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{label:"本季度进度",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-input",{staticClass:"Input",on:{input:function(e){return t.change(e)},blur:function(s){return t.onUpdateBonusSeason(e.$index,e.row)}},model:{value:e.row.progressInput,callback:function(s){t.$set(e.row,"progressInput",s)},expression:"scope.row.progressInput"}},[s("i",{staticClass:"icon iconfont icon-baifenbi",staticStyle:{"line-height":"40px"},attrs:{slot:"suffix"},slot:"suffix"})])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"bonusSeason",label:"本季度产值",align:"center"}})],1)],1),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",disabled:1===t.user.institute||"已录入"===t.form.stage_Status||"未录入"===t.form.stage_Status||"已发放"===t.form.stage_Status},on:{click:t.onSubmit}},[t._v("\n        确定\n      ")]),t._v(" "),s("el-button",{on:{click:t.goBack}},[t._v("\n        取消\n      ")])],1)],1)],1)},r=[],n=(s("96cf"),s("3b8d")),o=(s("a481"),s("c5f6"),s("3022"),s("ed08")),i=s("c28c"),l=s("a78e"),c=s.n(l),u={name:"ProjectProgress",data:function(){return{user:JSON.parse(c.a.get("userInfo")),project_CategoryList:[],design_StageList:[],stage_StatusList:[],specialtyList:[],checked:!1,form:{},total:0,tableData:[]}},components:{Tag:i["a"]},computed:{},methods:{change:function(t){this.$forceUpdate()},onUpdateBonusSeason:function(t,e){isNaN(e.progressInput)||Number(e.progressInput<0)?e.progressInput=0:Number(e.progressInput)>Number(e.progressReserved.replace("%",""))&&(e.progressInput=e.progressReserved.replace("%","")),e.progressInput=parseInt(e.progressInput),this.tableData[t].bonusSeason=(Number(e.progressInput)/e.progressSpecialtyLimit*Number(e.bonusInTotal)).toFixed(2)},goBack:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$router.push({path:"/bonus-principal-project/ProjectList"});case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onSubmit:function(){var t=this,e={projectId:this.form.project_Number,progress:this.tableData[0].progressInput/100,bonus:this.tableData[0].bonusSeason,progressStatus:!0};this.$store.dispatch("bonusPrincipal/updateProjectProgress",e).then((function(e){t.$message({message:"项目进度修改成功",type:"success"}),t.goBack()})).catch((function(e){t.$message({message:e,type:"error"})}))},getProgressInfo:function(t){var e=this;this.$store.dispatch("bonusPrincipal/getProjectProgressList",t).then((function(t){for(var s in e.form=t,e.form.stage_Status=Object(o["a"])(e.form.stage_Status,e.stage_StatusList),e.tableData=t.data,e.tableData)e.tableData[s].specialty=Object(o["a"])(e.tableData[s].specialty,e.specialtyList)})).catch((function(t){e.$message({message:t,type:"error"})}))},readSettings:function(){var t=this;this.$store.dispatch("settings/getSettings").then((function(e){t.project_CategoryList=e.projectCategory,t.design_StageList=e.designPhase,t.stage_StatusList=e.stageStatusDesignprinciple,t.specialtyList=e.placeList})).catch((function(){}))},init:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.readSettings(),this.getProgressInfo({id:this.$route.params.id});case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){this.init()}},p=u,m=p,g=(s("5715"),s("2877")),f=Object(g["a"])(m,a,r,!1,null,"fae28132",null);e["default"]=f.exports}}]);